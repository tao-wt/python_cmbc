#!/bin/envspacebashPLY#spacewriterspaceSY60216PLYPLYIFS=$'space\t\n'PLYPLYifspacetestspace$#space-ltspace2PLYthenPLYTABechospacesyntaxspaceerror!PLYTABexitspace3PLYfiPLYPLYfilename=`basenamespace$0`PLYfiledir=$(pwd)PLYicmd=$1PLYimod=$2PLYPLYcpuInfos=`catspace/proc/cpuinfo|spacegrepspace"processor"|spacewcspace-l`PLYmeminfos=$(freespace|spaceawkspace'FNR==2{printspace$2/(1024*1024)}')PLYPLYifspace[space`echospace$meminfosspace|spaceawkspace-vspacesetmem=28space'{printspace($1space>spacesetmem)?space'1':'0'}'`space-eqspace1space]PLYthenPLYTABXmx="2048m"PLYTABXms="1024m"PLYTABXss="512k"PLYTABPermSize="200m"PLYTABMaxPermSize="250m"PLYTABifspaceechospace$imodspace|spacegrepspacecmpspace>/dev/nullspace2>&1PLYTABthenPLYTABTABXmx="4096m"PLYTABTABXms="2048m"PLYTABTABPermSize="300m"PLYTABTABMaxPermSize="350m"PLYTABfiPLYelifspace[space`echospace$meminfosspace|spaceawkspace-vspacesetmem=14space'{printspace($1space>spacesetmem)?space'1':'0'}'`space-eqspace1space]PLYthenPLYTABXmx="1536m"PLYTABXms="1024m"PLYTABXss="512k"PLYTABPermSize="100m"PLYTABMaxPermSize="125m"PLYTABifspaceechospace$imodspace|spacegrepspacecmpspace>/dev/nullspace2>&1PLYTABthenPLYTABTABXmx="1843m"PLYTABTABXms="1331m"PLYTABTABPermSize="200m"PLYTABTABMaxPermSize="250m"PLYTABfiPLYelsePLYTABechospacethespacememoryspaceisspacetoospacesmall.PLYfiPLYPLYifspacetestspace"X$icmd"space=space"Xstart"PLYthenPLYTABpushdspace$filedirspace>/dev/nullspace2>&1PLYTABTAB/home/zhuser/jdk1.7.0_25/bin/javaspace-Xmx$Xmxspace-Xms$Xmsspace-Xss512kspace-XX:PermSize=$PermSizespace-XX:MaxPermSize=$MaxPermSizespace-XX:+UseG1GCspace-XX:MaxGCPauseMillis=100space-XX:NewRatio=1space-XX:SurvivorRatio=3space-XX:ConcGCThreads=4space-XX:ParallelGCThreads=$cpuInfosspace-XX:InitiatingHeapOccupancyPercent=60space-Dio.netty.leakDetectionLevel=advancedspace-jarspace$imod.jarspace>>spacenohup.outspace2>&1space&PLYTABpopdspace>/dev/nullspace2>&1PLYelifspace[space"X$icmd"space=space"Xstop"space]PLYthenPLYTABpsspace-efspace|spacegrepspace"/home/zhuser/jdk1.7.0_25/bin/javaspace-Xmx$Xmxspace-Xms$Xmsspace-Xss512kspace-XX:PermSize=$PermSizespace-XX:MaxPermSize=$MaxPermSizespace-XX:+UseG1GCspace-XX:MaxGCPauseMillis=100space-XX:NewRatio=1space-XX:SurvivorRatio=3space-XX:ConcGCThreads=4space-XX:ParallelGCThreads=$cpuInfosspace-XX:InitiatingHeapOccupancyPercent=60space-Dio.netty.leakDetectionLevel=advancedspace-jarspace${imod}.jar"space|spacegrepspace-vspacegrepspace|spaceawkspace'{printspace$2}'space|spacexargsspacekillspace$3PLYelsePLYTABechospaceinputspaceerror!spacemustspacebespacestartspaceorspacestop.PLYTABexitspace3PLYfiPLYPLYPLYPLY
