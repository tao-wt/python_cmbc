#!/usr/bin/envspacepythonPLY#spaceencoding:utf-8PLYPLYimportspacesysPLYimportspaceosPLYPLYsys.path.append("..")PLYfromspacelib.PublicSQLClassspaceimportspace*PLYfromspacelib.ParamikoClassspaceimportspace*PLYimportspacerePLYimportspacemultiprocessingPLYfromspaceoptparsespaceimportspaceOptionParserPLYimportspacetimePLYPLYPLYdefspacehelpFunc(a,b,c,d):PLYTABprintspace"\033[32;1mForspacehelp:"PLYTABprintspace"superstar.pyspace[-aspace(Allspaceip)space-ispace(IPspaceaddress,xx1,xx2..)space-Mspace(Modulespacename)space-sspace(Superspacemode)space-cspace(stop|O|restart)]"PLYTABprintspace"superstar.pyspace-aspace-cspacestart|stop|restartspace--allspace--cmdspacestart|stop|restart"PLYTABprintspace"superstar.pyspace-ispaceipaddr,[xx,xx]space-cspacestart|stop|restartspace--ipspacex1,x2,..space--cmdspacestart|stop|restart"PLYTABprintspace"superstar.pyspace-Mspacemodulename,[xx,xx]space-cspacestart|stop|restartspace--Modspacemod1,mod2space--cmdspacestart|stop|restart"PLYTABprintspace"superstar.pyspace-ispaceipaddr,[xx,xx]space-Mspacemodulename,[xx,xx]space-cspacestart|stop|restart"PLYTABprintspace'''---------------------------------------------------------------------------------------PLYForspaceexamples:PLY1spaceforspacegeneralspaceusage:PLYspacespacepythonspacesuperstar.pyspace-aspace-cspacestartPLYspacespacepythonspacesuperstar.pyspace-Mspacelogspace-cspacestartPLYspacespacepythonspacesuperstar.pyspace-ispace192.168.199.117,192.168.199.118space-cspacestartPLYspacespacepythonspacesuperstar.pyspace-ispace192.168.199.117,192.168.199.118space-Mspacelogspace-cspacestartPLY---------------------------------------------------------------------------------------\033[0m'''PLYPLYdefspacecheck_Ip(ip):PLYTABhostsspace=space[]PLYTABhosts_okspace=space[]PLYTABiphostspace=spacet.findAllHosts()PLYTABforspacehspaceinspaceiphost:PLYTABTABhosts.append(str(h[0]))PLYTABforspaceispaceinspaceip:PLYTABTABifspaceispacenotspaceinspacehosts:PLYTABTABTABprintspace"\033[1;31;40m%sspacemodulespacenotspaceexist,pleasespacecheck!\033[0m"space%iPLYTABTABTAB#continuePLYTABTABTABsys.exit(3)PLYPLYdefspacecheck_ModName(mod):PLYTABmodnamesspace=space[]PLYTABmodulenamespace=spacet.findAllPubName()PLYTABforspacemspaceinspacemodulename:PLYTABTABmodnames.append(str(m[0]))PLYTABforspacemnspaceinspacemod:PLYTABTABifspacemnspacenotspaceinspacemodnames:PLYTABTABTABprintspace"\033[1;31;40mModNamespace%sspacenotspaceexist,pleasespacecheck!\033[0m"space%mnPLYTABTABTABprintspace30*'*'PLYTABTABTABprintspace"\033[1;33;40mInputspaceReferencespaceModName:\033[0m"spacePLYTABTABTABforspacemspaceinspacemodnames:PLYTABTABTABTABprintspace"\033[1;33;40m%s\033[0m"space%mPLYTABTABTABsys.exit(3)PLYPLYifspacelen(sys.argv)space!=space1:PLYspacespacespacespacespacespacespacespaceifspace"-"spaceinspacesys.argv:PLYspacespacespacespacespacespacespacespacespacespacespacespacespacespacespacespaceprintspace"\033[1;31;40merrorspaceargv:-,pleasespacemodify!\033[0m"PLYspacespacespacespacespacespacespacespacespacespacespacespacespacespacespacespacesys.exit(3)PLYparserspace=spaceOptionParser(add_help_option=0)PLYparser.add_option("-h",space"--help",spaceaction="callback",spacecallback=helpFunc)PLYparser.add_option("-c",space"--cmd",spaceaction="store",spacetype="string",spacedest="cmd",default="")PLYparser.add_option("-a",space"--all",spaceaction="store_true",spacedest="all")PLYparser.add_option("-i",space"--ip",spaceaction="store",spacetype="string",spacedest="ip",spacedefault="")PLYparser.add_option("-M",space"--Mod",spaceaction="store",spacetype="string",spacedest="modname",spacedefault="")PLYparser.add_option("-m",space"--mid",spaceaction="store",spacetype="string",spacedest="mid",default="")PLYparser.add_option("-n",space"--number",spaceaction="store",spacetype="string",spacedest="number",default="")PLYparser.add_option("-f",space"--force",spaceaction="store_true",spacedest="killforce")PLYPLY(options,spaceargs)space=spaceparser.parse_args()PLYruncmd=options.cmdPLYrunall=options.allPLYrunip=options.ipPLYmid=options.midPLYrunmod=options.modnamePLYorder=options.number.split(',')PLYcommandoption=argsPLYkillforce=options.killforcePLYnum=8PLYPLYtspace=spaceSQLClass()PLYPLYuser="zhuser"PLYuserInfospace=spacet.findUserPass(user)PLYPLYforspaceispaceinspaceuserInfo:PLYTABportspace=spaceint(i[0])PLYTABpasswdspace=spacestr(i[1])PLYPLY#启停所有模块函数spaceBEGINPLYPLYip_list=[]PLYip_cmd_list=[]PLYforspaceipspaceinspacet.findAllIp():PLYTABip_list.append(ip[0])PLYPLYinput_ip_list=runip.strip().split(',')space#获取-i给出的IP地址列表PLYall_ip_list=[]PLYinput_mod_list=runmod.strip().split(',')PLYsomemod=[]PLYPLYPLYdefspacestartAll(j):PLYTABloginspace=spaceParamikoClass(j,port,user,passwd)PLYTABforspaceipspaceinspacet.findIpcmd(j):PLYTABTABcmd_1=ip[1].strip().split("/")[:-1]PLYTABTABcmd_path="/".join(cmd_1)PLYTABTABcmd_start=ip[1].strip().split("/")[-1]PLYTABTABcmd_mod=ip[1].strip().split("/")[3]PLYTABTABprintspace"\033[32;1m%sspace%sspacehasspacebeenspacestarted\033[0m"%(ip[0],cmd_mod)PLYTABTABlogin.cmd_run("cdspace"+cmd_path+";/bin/shspace"+spacecmd_start)PLYPLYdefspacestopAll(j):PLYTABloginspace=spaceParamikoClass(j,port,user,passwd)PLYTABforspaceipspaceinspacet.findIpname(j):PLYTABTABprintspace"\033[31;1m%sspace%sspacehasspacebeenspacekilled\033[0m"space%(ip[0],ip[1])PLYTABTABifspacekillforcespace==spaceTruespace:PLYTABTABTABstopforce="-9"PLYTABTABelse:PLYTABTABTABstopforce=""PLYTABTABcmd="psspace-ef|grepspace%s|grepspace-vspacegrep|awkspace'{printspace$2}'|xargsspacekillspace%sspace"space%(ip[1],stopforce)PLYTABTABlogin.cmd_run(cmd)PLYPLYdefspacerestartAll(j):PLYTABforspaceipspaceinspacet.findIpname(j):PLYTABTABprintspace"\033[31;1m%sspace%sspacehasspacebeenspacekilled\033[0m"space%(ip[0],ip[1])PLYTABTABloginspace=spaceParamikoClass(ip[0],port,user,passwd)PLYTABTABcmd="psspace-ef|grepspacespace%s|grepspace-vspacegrep|awkspace'{printspace$2}'|xargsspacekillspace"space%ip[1]PLYTABTABlogin.cmd_run(cmd)PLYPLYTABforspaceipspaceinspacet.findIpcmd(j):PLYTABTABcmd_1=ip[1].strip().split("/")[:-1]PLYTABTABcmd_path="/".join(cmd_1)PLYTABTABcmd_start=ip[1].strip().split("/")[-1]PLYTABTABcmd_mod=ip[1].strip().split("/")[3]PLYTABTABloginspace=spaceParamikoClass(ip[0],port,user,passwd)PLYTABTABprintspace"\033[32;1m%sspace%sspacehasspacebeenspacestarted\033[0m"%(ip[0],cmd_mod)PLYTABTABlogin.cmd_run("cdspace"+cmd_path+";shspace"+spacecmd_start)PLYPLYdefspacespacestartMod(ip):PLYTABloginspace=spaceParamikoClass(ip,port,user,passwd)PLYTABforspacemodspaceinspaceinput_mod_list:PLYTABTABforspaceispaceinspacet.findIpAndMod(ip,mod):PLYTABTABTABcmd_start=i[1].strip().split("/")[-1]PLYTABTABTABcmd_1=i[1].strip().split("/")[:-1]PLYTABTABTABcmd_path="/".join(cmd_1)PLYTABTABTABcmd_mod=i[1].strip().split("/")[3]PLYTABTABTABprintspace"\033[32;1m%sspace%sspacehasspacebeenspacestarted\033[0m"space%(ip,cmd_mod)PLYTABTABTABlogin.cmd_run("cdspace"+cmd_path+";/bin/shspace"+spacecmd_start)PLYPLYdefspacespacestopMod(ip):PLYTABloginspace=spaceParamikoClass(ip,port,user,passwd)PLYTABforspacemodspaceinspaceinput_mod_list:PLYTABTABforspaceispaceinspacet.findIpAndMod(ip,mod):PLYTABTABTABcmd_1=i[1].strip().split("/")[:-1]PLYTABTABTABcmd_path="/".join(cmd_1)PLYTABTABTABcmd_mod=cmd_path.strip().split("/")[3]PLYTABTABTABifspacekillforcespace==spaceTruespace:PLYTABTABTABTABstopforce="-9"PLYTABTABTABelse:PLYTABTABTABTABstopforce=""PLYTABTABTABcmd="psspace-efspace|spacegrepspace-wspace%sspace|spacegrepspace-vspacegrep|awkspace'{printspace$2}'space|spacexargsspacekillspace%sspace"space%(cmd_mod,stopforce)PLYTABTABTAB#printspacecmdPLYTABTABTABprintspace"\033[31;1m%sspace%sspacehasspacebeenspacekilled\033[0m"space%(ip,cmd_mod)PLYTABTABTABlogin.cmd_run(cmd)PLYPLYdefspacespacerestartMod(ip):PLYTABloginspace=spaceParamikoClass(ip,port,user,passwd)PLYTABforspacemodspaceinspaceinput_mod_list:PLYTABTABforspaceispaceinspacet.findIpAndMod(ip,mod):PLYTABTABTABcmd_1=i[1].strip().split("/")[:-1]PLYTABTABTABcmd_path="/".join(cmd_1)PLYTABTABTABcmd_mod=cmd_path.strip().split("/")[3]PLYTABTABTABcmd="psspace-ef|grepspace-wspace%s|grepspace-vspacegrep|awkspace'{printspace$2}'|xargsspacekillspace"space%cmd_modPLYTABTABTABprintspace"\033[31;1m%sspace%sspacehasspacebeenspacekilled\033[0m"space%(ip,cmd_mod)PLYTABTABTABlogin.cmd_run(cmd)PLYPLYTABforspacemodspaceinspaceinput_mod_list:PLYTABTABforspaceispaceinspacet.findIpAndMod(ip,mod):PLYTABTABTABcmd_start=i[1].strip().split("/")[-1]PLYTABTABTABcmd_1=i[1].strip().split("/")[:-1]PLYTABTABTABcmd_path="/".join(cmd_1)PLYTABTABTABlogin.cmd_run("cdspace"+cmd_path+";shspace"+spacecmd_start)PLYPLYdefspacestartModAll(mod):PLYTABinfolistspace=spacet.findIpOnlyMod(mod,orderStr)PLYTABmodlenspace=spacespacelen(infolist)PLYTABcountspace=spacemodlen/2PLYTABlinfospace=spacemodlen%2PLYTABifspacelinfospace!=space0:PLYTABTABcountspace=spacecount+1PLYTABifspacemidspace==space"head":PLYTABTABispace=space0PLYTABTABwhilespaceispace<spacecount:PLYTABTABTABloginspace=spaceParamikoClass(infolist[i][0],port,user,passwd)PLYTABTABTABcmd_1=infolist[i][1].strip().split("/")[:-1]PLYTABTABTABcmd_path="/".join(cmd_1)PLYTABTABTABcmd_start=infolist[i][1].strip().split("/")[-1]PLYTABTABTABcmd_mod=infolist[i][1].strip().split("/")[3]PLYTABTABTABprintspace"\033[32;1m%sspace%sspacehasspacebeenspacestarted\033[0m"%(infolist[i][0],cmd_mod)PLYTABTABTABlogin.cmd_run("cdspace"+cmd_path+";shspace"+spacecmd_start)PLYTABTABTABispace=spacei+1PLYTABelifspacemidspace==space"tail":PLYTABTABispace=spacecountPLYTABTABwhilespaceispace<spacemodlen:PLYTABTABTABloginspace=spaceParamikoClass(infolist[i][0],port,user,passwd)PLYTABTABTABcmd_1=infolist[i][1].strip().split("/")[:-1]PLYTABTABTABcmd_path="/".join(cmd_1)PLYTABTABTABcmd_start=infolist[i][1].strip().split("/")[-1]PLYTABTABTABcmd_mod=infolist[i][1].strip().split("/")[3]PLYTABTABTABprintspace"\033[32;1m%sspace%sspacehasspacebeenspacestarted\033[0m"%(infolist[i][0],cmd_mod)PLYTABTABTABlogin.cmd_run("cdspace"+cmd_path+";shspace"+spacecmd_start)PLYTABTABTABispace=spacei+1PLYTABelse:PLYTABTABforspaceipspaceinspaceinfolist:PLYTABTABTABloginspace=spaceParamikoClass(ip[0],port,user,passwd)PLYTABTABTABcmd_1=ip[1].strip().split("/")[:-1]PLYTABTABTABcmd_path="/".join(cmd_1)PLYTABTABTABcmd_start=ip[1].strip().split("/")[-1]PLYTABTABTABcmd_mod=ip[1].strip().split("/")[3]PLYTABTABTABprintspace"\033[32;1m%sspace%sspacehasspacebeenspacestarted\033[0m"%(ip[0],cmd_mod)PLYTABTABTABlogin.cmd_run("cdspace"+cmd_path+";shspace"+spacecmd_start)PLYPLYdefspacestopModAll(mod):PLYTABinfolistspace=spacet.findIpOnlyMod(mod,orderStr)PLYTABmodlenspace=spacespacelen(infolist)PLYTABcountspace=spacemodlen/2PLYTABlinfospace=spacemodlen%2PLYTABifspacelinfospace!=space0:PLYTABTABcountspace=spacecount+1PLYTABifspacemidspace==space"head":PLYTABTABispace=space0PLYTABTABwhilespaceispace<spacecount:PLYTABTABTABloginspace=spaceParamikoClass(infolist[i][0],port,user,passwd)PLYTABTABTABcmd_1=infolist[i][1].strip().split("/")[:-1]PLYTABTABTABcmd_path="/".join(cmd_1)PLYTABTABTABcmd_mod=cmd_path.strip().split("/")[3]PLYTABTABTABifspacekillforcespace==spaceTruespace:PLYTABTABTABTABstopforce="-9"PLYTABTABTABelse:PLYTABTABTABTABstopforce=""PLYTABTABTABcmd="psspace-efspace|spacegrepspace-wspace%sspace|spacegrepspace-vspacegrepspace|spaceawkspace'{printspace$2}'space|spacexargsspacekillspace%sspace"space%(cmd_mod,stopforce)PLYTABTABTABprintspace"\033[31;1m%sspace%sspacehasspacebeenspacekilled\033[0m"space%(infolist[i][0],cmd_mod)PLYTABTABTABlogin.cmd_run(cmd)PLYTABTABTABispace=spacei+1PLYTABelifspacemidspace==space"tail":PLYTABTABispace=spacecountPLYTABTABwhilespaceispace<spacemodlen:PLYTABTABTABloginspace=spaceParamikoClass(infolist[i][0],port,user,passwd)PLYTABTABTABcmd_1=infolist[i][1].strip().split("/")[:-1]PLYTABTABTABcmd_path="/".join(cmd_1)PLYTABTABTABcmd_mod=cmd_path.strip().split("/")[3]PLYTABTABTABifspacekillforcespace==spaceTruespace:PLYTABTABTABTABstopforce="-9"PLYTABTABTABelse:PLYTABTABTABTABstopforce=""PLYTABTABTABcmd="psspace-efspace|spacegrepspace-wspace%sspace|spacegrepspace-vspacegrepspace|spaceawkspace'{printspace$2}'space|spacexargsspacekillspace%sspace"space%(cmd_mod,stopforce)PLYTABTABTABprintspace"\033[31;1m%sspace%sspacehasspacebeenspacekilled\033[0m"space%(infolist[i][0],cmd_mod)PLYTABTABTABlogin.cmd_run(cmd)PLYTABTABTABispace=spacei+1PLYTABelse:PLYTABTABforspaceipspaceinspaceinfolist:PLYTABTABTABloginspace=spaceParamikoClass(ip[0],port,user,passwd)PLYTABTABTABcmd_1=ip[1].strip().split("/")[:-1]PLYTABTABTABcmd_path="/".join(cmd_1)PLYTABTABTABcmd_mod=cmd_path.strip().split("/")[3]PLYTABTABTABifspacekillforcespace==spaceTruespace:PLYTABTABTABTABstopforce="-9"PLYTABTABTABelse:PLYTABTABTABTABstopforce=""PLYTABTABTABcmd="psspace-efspace|spacegrepspace-wspace%sspace|spacegrepspace-vspacegrepspace|spaceawkspace'{printspace$2}'space|spacexargsspacekillspace%sspace"space%(cmd_mod,stopforce)PLYTABTABTABprintspace"\033[31;1m%sspace%sspacehasspacebeenspacekilled\033[0m"space%(ip,cmd_mod)PLYTABTABTABlogin.cmd_run(cmd)PLYPLYdefspacerestartModAll(mod):PLYTABforspaceipspaceinspacespacet.findIpOnlyMod(mod,orderStr):PLYTABTABloginspace=spaceParamikoClass(ip[0],port,user,passwd)PLYTABTABcmd_1=ip[1].strip().split("/")[:-1]PLYTABTABcmd_path="/".join(cmd_1)PLYTABTABcmd_mod=cmd_path.strip().split("/")[3]PLYTABTABcmd="psspace-ef|grepspace-wspace%s|grepspace-vspacegrep|awkspace'{printspace$2}'|xargsspacekillspace"space%cmd_modPLYTABTABprintspace"\033[31;1m%sspace%sspacehasspacebeenspacekilled\033[0m"space%(ip[0],cmd_mod)PLYTABTABlogin.cmd_run(cmd)PLYPLYTABforspaceipspaceinspacespacet.findIpOnlyMod(mod,orderStr):PLYTABTABloginspace=spaceParamikoClass(ip[0],port,user,passwd)PLYTABTABcmd_1=ip[1].strip().split("/")[:-1]PLYTABTABcmd_path="/".join(cmd_1)PLYTABTABcmd_start=ip[1].strip().split("/")[-1]PLYTABTABcmd_mod=ip[1].strip().split("/")[3]PLYTABTABprintspace"\033[32;1m%sspace%sspacehasspacebeenspacestarted\033[0m"%(ip[0],cmd_mod)PLYTABTABlogin.cmd_run("cdspace"+cmd_path+";shspace"+spacecmd_start)PLYPLY#检查参数:ip,mod,mid是否合法兼容PLYifspaceinput_ip_listspace!=space['']:PLYTABcheck_Ip(input_ip_list)PLYifspaceinput_mod_listspace!=space['']:PLYTABcheck_ModName(input_mod_list)PLYifspacemidspace!=space"":PLYTABifspacemidspace!=space"head"spaceandspacemidspace!=space"tail":PLYTABTABprintspace"\033[1;31;40mmidspacenotspacecorrect,pleasespacecheck!\033[0m"PLYTABTABsys.exit(3)PLYifspaceorderspace!=space['']:PLYTABorder_newspace=spaceorderPLYTABorderspace=space['']PLYTABforspacei,jspaceinspaceenumerate(order_new):PLYTABTABjspace=spacere.sub(r'[a-zA-Z]*',"",j,0)PLYTABTABifspacej.find("-",0,len(j))space!=space-1:PLYTABTABTAB#spacejspace=spacej.upper().replace("CP","")PLYTABTABTABoj=j.split('-')PLYTABTABTABforspaceiobjspaceinspacerange(int(oj[0]),int(oj[1])+1):PLYTABTABTABTABorder.append("CP%s"%iobj)PLYTABTABelse:PLYTABTABTABorder.append("CP%s"%j)PLYTABTABTAB#spaceorder.append(order_new[i].upper())PLY#spaceifspacelen(input_mod_list)space!=space1spaceandspacemidspace!=space"":PLYTAB#spaceprintspace"\033[1;31;40mmidspaceandspaceseveralspacemodulesspacecannotspaceusespacetogether,pleasespacemodify!\033[0m"PLYTAB#spacesys.exit(3)PLYifspacelen(input_mod_list)space!=space1spaceandspaceorderspace!=space['']:PLYTABprintspace"\033[1;31;40morderspaceandspaceseveralspacemodulesspacecannotspaceusespacetogether,pleasespacemodify!\033[0m"PLYTABsys.exit(3)PLYifspaceorderspace!=space['']spaceandspacemidspace!=space"":PLYTABprintspace"\033[1;31;40mmidspaceandspaceorderspacenumberspacecannotspaceusespacetogether,pleasespacemodify!\033[0m"PLYTABsys.exit(3)PLYifspaceorderspace!=space['']spaceandspaceinput_ip_listspace!=space['']:PLYTABprintspace"\033[1;31;40mipspaceandspaceorderspacenumberspacecannotspaceusespacetogether,pleasespacemodify!\033[0m"PLYTABsys.exit(3)PLYifspaceinput_ip_listspace!=space['']spaceandspacemidspace!=space"":PLYTABprintspace"\033[1;31;40mmidspaceandspaceipspacecannotspaceusespacetogether,pleasespacemodify!\033[0m"PLYTABsys.exit(3)PLYPLY#逻辑层PLYorderStrspace=space""PLYifspaceorderspace!=space['']:PLYTABorderStrspace=space"spaceandspace("PLYTABforspacenspaceinspaceorder:PLYTABTABorderStrspace=spaceorderStrspace+space"CPname='%s'spaceorspace"%nPLYTABorderStrspace=spacere.sub(r'spaceorspace$',")",orderStr,0)PLY#指定IP和mod名字PLYifspacelen(input_mod_list[0])space!=space0spaceandspacespaceruncmdspace==space"start"spaceandspacelen(input_ip_list[0])space!=space0:#模块名字spaceIPspace命令三项同时存在PLYTABpoolspace=spacemultiprocessing.Pool(processes=num)PLYTABforspacespaceipspaceinspaceinput_ip_list:PLYTABTABpool.apply_async(startMod,(ip,))PLYTABpool.close()PLYTABpool.join()PLYPLYelifspacelen(input_mod_list[0])space!=space0spaceandspacespaceruncmdspace==space"stop"spaceandspacelen(input_ip_list[0])space!=space0:PLYTABpoolspace=spacemultiprocessing.Pool(processes=num)PLYTABforspacespaceipspaceinspaceinput_ip_list:PLYTABTABpool.apply_async(stopMod,(ip,))PLYTABpool.close()PLYTABpool.join()PLYPLYelifspacelen(input_mod_list[0])space!=space0spaceandspacespaceruncmdspace==space"restart"spaceandspacelen(input_ip_list[0])space!=space0:PLYTABpoolspace=spacemultiprocessing.Pool(processes=num)PLYTABforspacespaceipspaceinspaceinput_ip_list:PLYTABTABpool.apply_async(restartMod,(ip,))PLYTABpool.close()PLYTABpool.join()PLYPLY#指定spaceIP列表PLYelifspacelen(input_mod_list[0])space==space0spaceandspaceruncmdspace==space"start"spaceandspacelen(input_ip_list[0])space!=space0:PLYTABpoolspace=spacemultiprocessing.Pool(processes=num)PLYTABforspacejspaceinspaceinput_ip_list:PLYTABTABpool.apply_async(startAll,(j,))PLYTABpool.close()PLYTABpool.join()PLYPLYelifspacelen(input_mod_list[0])space==space0spaceandspaceruncmdspace==space"stop"spaceandspacelen(input_ip_list[0])space!=space0:PLYTABpoolspace=spacemultiprocessing.Pool(processes=num)PLYTABforspacejspaceinspaceinput_ip_list:PLYTABTABpool.apply_async(stopAll,(j,))PLYTABpool.close()PLYTABpool.join()PLYPLYelifspacelen(input_mod_list[0])space==space0spaceandspaceruncmdspace==space"restart"spaceandspacelen(input_ip_list[0])space!=space0:PLYTABpoolspace=spacemultiprocessing.Pool(processes=num)PLYTABforspacejspaceinspaceinput_ip_list:PLYTABTABpool.apply_async(restartAll,(j,))PLYTABpool.close()PLYTABpool.join()PLYPLY#指定spacemodule列表PLYelifspacelen(input_ip_list[0])space==space0spaceandspaceruncmdspace==space"start"spaceandspacelen(input_mod_list[0])space!=space0:PLYTABpoolspace=spacemultiprocessing.Pool(processes=num)PLYTABforspacemodspaceinspaceinput_mod_list:PLYTABTABpool.apply_async(startModAll,(mod,))PLYTABpool.close()PLYTABpool.join()PLYPLYelifspacelen(input_ip_list[0])space==space0spaceandspaceruncmdspace==space"stop"spaceandspacelen(input_mod_list[0])space!=space0:PLYTABpoolspace=spacemultiprocessing.Pool(processes=num)PLYTABforspacemodspaceinspaceinput_mod_list:PLYTABTABpool.apply_async(stopModAll,(mod,))PLYTABpool.close()PLYTABpool.join()PLYPLYelifspacelen(input_ip_list[0])space==space0spaceandspaceruncmdspace==space"restart"spaceandspacelen(input_mod_list[0])space!=space0:PLYTABpoolspace=spacemultiprocessing.Pool(processes=num)PLYTABforspacemodspaceinspaceinput_mod_list:PLYTABTABpool.apply_async(restartModAll,(mod,))PLYTABpool.close()PLYTABpool.join()PLYPLY#全部模块启停PLYelifspacespaceruncmdspace==space"start":PLYTABpoolspace=spacemultiprocessing.Pool(processes=num)PLYTABforspacespaceipspaceinspaceip_list:PLYTABTABpool.apply_async(startAll,(ip,))PLYTABpool.close()PLYTABpool.join()PLYPLYelifspacespaceruncmdspace==space"stop":PLYTABpoolspace=spacemultiprocessing.Pool(processes=num)PLYTABforspacespaceipspaceinspaceip_list:PLYTABTABpool.apply_async(stopAll,(ip,))PLYTABpool.close()PLYTABpool.join()PLYPLYelifspacespaceruncmdspace==space"restart":PLYTABpoolspace=spacemultiprocessing.Pool(processes=num)PLYTABforspacespaceipspaceinspaceip_list:PLYTABTABpool.apply_async(restartAll,(ip,))PLYTABpool.close()PLYTABpool.join()PLYPLYelse:PLYTABprintspace"wrongspaceargs"PLYPLY
